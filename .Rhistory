label = c('count')) +
theme(legend.position = '0') +
labs(caption = 'End the Syndemic | DataLab 2022',
title = 'Hospitalizations overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019') +
scale_fill_distiller(palette = "RdBu", direction = 1) +
scale_color_brewer(palette = "Set1")
#Creates a list of SUDs & ENDO or SSTVI for the ggvenn package to read
syndemic_list <-
list('SUDs' = which(md$sud),
'SSTVIs or Endocarditis' = which(md$endo | md$sstvi))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(caption = 'End the Syndemic | DataLab 2022',
title = 'Hospitalizations overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019') +
scale_fill_distiller(palette = "RdBu", direction = 1) +
scale_color_brewer(palette = "Set1")
for (i in range(5)),
print('Up my sleeves')
source("~/DataLab/Syndemic/syndemic/syndemic_graphs_jacob.R", echo=TRUE)
######################## Trends in hospitalization incidence rates by age group ----
age <- md %>% mutate(Ages = ifelse(Age %in% 0:17, 0-17, 'ttt'))
View(age)
######################## Trends in hospitalization incidence rates by age group ----
age <- md %>% mutate(Ages = ifelse(Age %in% 0:17, '0-17', 'ttt'))
######################## Trends in hospitalization incidence rates by age group ----
age <- md %>% mutate(Ages = ifelse(Age %in% 0:17, '0-17',
Age %in% 18:24, '18-24',
Age %in% 25:34, '25-34',
Age %in% 35:44, '35-44',
Age %in% 45:54, '45-54',
Age %in% 55:64, '55-64', '65+'))
######################## Trends in hospitalization incidence rates by age group ----
age <- md %>% mutate(Ages = ifelse(Age %in% 0:17, '0-17',
Age %in% 18:24, '18-24',
Age %in% 25:34, '25-34',
Age %in% 35:44, '35-44',
Age %in% 45:54, '45-54',
Age %in% 55:64, '55-64', '65+'))
######################## Trends in hospitalization incidence rates by age group ----
age <- md %>% mutate(Ages = ifelse(Age %in% 0:17, '0-17',
ifelse(Age %in% 18:24, '18-24',
ifelse(Age %in% 25:34, '25-34',
ifelse(Age %in% 35:44, '35-44',
ifelse(Age %in% 45:54, '45-54',
ifelse(Age %in% 55:64, '55-64', '65+'))))))))
######################## Trends in hospitalization incidence rates by age group ----
age <- md %>% mutate(Ages = ifelse(Age %in% 0:17, '0-17',
ifelse(Age %in% 18:24, '18-24',
ifelse(Age %in% 25:34, '25-34',
ifelse(Age %in% 35:44, '35-44',
ifelse(Age %in% 45:54, '45-54',
ifelse(Age %in% 55:64, '55-64', '65+')))))))
View(age)
#Adds same age groups as used in michigan study to the master dataset
md <- md %>% mutate(Age_Groups = ifelse(Age %in% 0:17, '0-17',
ifelse(Age %in% 18:24, '18-24',
ifelse(Age %in% 25:34, '25-34',
ifelse(Age %in% 35:44, '35-44',
ifelse(Age %in% 45:54, '45-54',
ifelse(Age %in% 55:64, '55-64', '65+')))))))
View(md)
source("~/DataLab/Syndemic/syndemic/syndemic_graphs_jacob.R", echo=TRUE)
?palette
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(caption = 'End the Syndemic | DataLab 2022',
title = 'Hospitalizations overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019') +
scale_fill_distiller(palette = "Set1", direction = 1) +
scale_color_brewer(palette = "Set1")
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(caption = 'End the Syndemic | DataLab 2022',
title = 'Hospitalizations overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019') +
scale_fill_distiller(palette = "Set2", direction = 1) +
scale_color_brewer(palette = "Set1")
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(caption = 'End the Syndemic | DataLab 2022',
title = 'Hospitalizations overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019') +
scale_fill_distiller(palette = "Set3", direction = 1) +
scale_color_brewer(palette = "Set1")
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(caption = 'End the Syndemic | DataLab 2022',
title = 'Hospitalizations overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019') +
scale_fill_distiller(palette = "Set3", direction = 1) +
scale_color_brewer(palette = "Set3")
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(caption = 'End the Syndemic | DataLab 2022',
title = 'Hospitalizations overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019') +
scale_fill_distiller(palette = "Set3", direction = 1) +
scale_color_brewer(palette = "Set2")
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(caption = 'End the Syndemic | DataLab 2022',
title = 'Hospitalizations overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019') +
scale_fill_distiller(palette = "Set3", direction = 3) +
scale_color_brewer(palette = "Set2")
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(caption = 'End the Syndemic | DataLab 2022',
title = 'Hospitalizations overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019') +
scale_fill_distiller(palette = "Set3", direction = 1) +
scale_color_brewer(palette = "Set2")
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(caption = 'End the Syndemic | DataLab 2022',
title = 'Hospitalizations overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019') +
scale_fill_distiller(palette = "Blues", direction = 1) +
scale_color_brewer(palette = "Set2")
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(caption = 'End the Syndemic | DataLab 2022',
title = 'Hospitalizations overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019') +
scale_fill_distiller(palette = "OrRd", direction = 1) +
scale_color_brewer(palette = "Set2")
source("~/DataLab/Syndemic/syndemic/syndemic_graphs_jacob.R", echo=TRUE)
library(RColorBrewer)
#Creates palette we will use
mycols <- colors()[c(8, 5, 30, 53, 118, 72)]
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_fill_distiller(palette = "mycols", direction = 1) +
scale_color_brewer(palette = "Set2")
########################
library(tidyverse)
library(ggVennDiagram)
library(forcats)
library(lubridate)
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_fill_distiller(palette = "mycols", direction = 1) +
scale_color_brewer(palette = "Set2")
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_fill_distiller(palette = mycols, direction = 1) +
scale_color_brewer(palette = "Set2")
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_fill_distiller(palette = 'Set2', direction = 1) +
scale_color_brewer(palette = mycols)
"Set2"
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_fill_distiller(palette = 'Set2', direction = 1) +
scale_color_brewer(palette = "Set2")
library(RColorBrewer)
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_fill_distiller(palette = 'mycols', direction = 1) +
scale_color_brewer(palette = "Set2")
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_fill_distiller(palette = mycols, direction = 1) +
scale_color_brewer(palette = "Set2")
source("~/DataLab/Syndemic/syndemic/syndemic_graphs_jacob.R", echo=TRUE)
library(lubridate)
source("~/DataLab/Syndemic/syndemic/syndemic_graphs_jacob.R", echo=TRUE)
?scale_color_manual
scale_color_manual(values = c('red','white','blue')
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('red','white','blue'))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('red','white','blue', 'red'))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('red','white','blue', 'red', 'red'))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('red','white','blue'))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('black','black','blue'))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('black','black','blue', 'red'))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('black','black','red'))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('black','black','red'))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('black','black')) +
scale_fill_manual(values = c('red'))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('black','black')) +
scale_fill_discrete(values = c('red'))
manual
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('black','black')) +
scale_fill_manual(values = 'red')
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('black','black')) +
scale_fill_disteller(values = c('red'))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('black','black')) +
scale_fill_distiller(values = c('red'))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('black','black')) +
scale_fill_gradientn(values = c('red'))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('black','black')) +
scale_fill_gradientn(colors = c('red'))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('black','black')) +
scale_fill_gradientn(colors = c('red', 'blue'))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('black','black')) +
scale_fill_gradientn(colors = c('red', 'blue', 'yellow'))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('black','black')) +
scale_fill_gradientn(colors = c('red', 'blue', 'yellow', 'pink'))
#Creates a venn diagram showing overlap in SUDS and syndemic related ICD-10s
ggVennDiagram(syndemic_list,
label_size = 4,
label_alpha = 0.3,
label = c('count')) +
theme(legend.position = '0') +
labs(title = 'Hospitalization overlap for substance use disorder (SUDs) and infectious sequela of interest',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022') +
scale_color_manual(values = c('black','black')) +
scale_fill_gradientn(colors = c('red', 'blue', 'yellow', 'pink', 'green'))
View(md)
source("~/DataLab/Syndemic/syndemic/syndemic_graphs_jacob.R", echo=TRUE)
md <- read_csv('masterdata.csv') %>% filter(TN_Res_Flag == TRUE)
md <- read_csv('masterdata.csv')
md <- read_csv('masterdata.csv') %>% filter(TN_Res_Flag == TRUE)
md <- read_csv('masterdata.csv')
md <- md %>% filter(TN_Res_Flag == TRUE)
md <- read_csv('masterdata.csv') #%>% filter(TN_Res_Flag == TRUE)
md <- read_csv('masterdata.csv') #%>% filter(TN_Res_Flag == TRUE)
md <- read_csv('masterdata.csv') %>% filter(TN_Res_Flag == 'Y')
source("~/DataLab/Syndemic/syndemic/syndemic_graphs_jacob.R", echo=TRUE)
source("~/DataLab/Syndemic/syndemic/syndemic_graphs_jacob.R", echo=TRUE)
setwd("~/DataLab/Syndemic/syndemic")
source("~/DataLab/Syndemic/syndemic/syndemic_graphs_jacob.R", echo=TRUE)
#Sets up an object that groups by primary payer,
#sums the total costs each payer paid for syndemic patients,
#only saves the top 5,
#and then adds a new column, gov, for if it was funded by the government or not
md_top_payers <- md %>%
filter(sud, endo | sstvi) %>%
group_by(Primary_Payer_Class_Cd) %>%
summarise(total = sum(Total_Tot_Chrg)) %>%
arrange(desc(total)) %>%
head(5) %>%
mutate(gov = ifelse(Primary_Payer_Class_Cd %in% c('M','K','J', '8'), TRUE, FALSE))
#Renames the primary payers to their common name
md_top_payers$Primary_Payer_Class_Cd <- fct_recode(md_top_payers$Primary_Payer_Class_Cd,
'Medicare' = 'M',
'Medicare Advantage' = 'K',
'Self-Pay' = 'P',
'Blue Care' = 'J',
'Americhoice' = '8')
#Plots the top 5 primary payers by their costs paid for syndemic patients
ggplot(data = md_top_payers,
aes(y = total/100000000,
x = reorder(Primary_Payer_Class_Cd, -total),
fill = gov ) ) +
geom_col() +
labs(title = 'Total Costs Covered by Top 5 Healthcare Providers',
subtitle = 'TN Hospitals 2019 | Inpatient and Outpatient',
caption = 'End the Syndemic | DataLab 2022',
x = 'Primary Provider',
y = 'Cost Paid (in millions of US dollars)') +
scale_fill_manual(md_top_payers, values = c('#1B365D', '#C11701'),
labels = c('Privately Funded', 'Government Funded', '', '', ''),
name = 'Color Legend:') +
theme(legend.position = 'bottom') +
theme(axis.text.x = element_text(angle = 10))
